function a(){form=rcmail.gui_objects.messageform;formData=new FormData();formData.append('_mode',rcmail.editor.is_html()?'html':'txt');formData.append('message',rcmail.editor.get_content());formData.append('_subject',$('[name=\'_subject\']',form).val().trim());formData.append('_from',$('[name=\'_from\']',form).val());formData.append('_to',$('[name=\'_to\']',form).val());input_cc=$('[name=\'_cc\']',form).val().trim().split(',').map(addr=>addr.trim());formData.append('_cc',input_cc);input_bcc=$('[name=\'_bcc\']',form).val().trim().split(',').map(addr=>addr.trim());formData.append('_bcc',input_bcc);input_replyto=$('[name=\'_replyto\']',form).val().trim().split(',').map(addr=>addr.trim());formData.append('_replyto',input_replyto);input_followupto=$('[name=\'_followupto\']',form).val().trim().split(',').map(addr=>addr.trim());formData.append('_followupto',input_followupto);formData.append('_separator',$('#mailmergesep').val());formData.append('_enclosure',$('#mailmergeencl').val());formData.append('_folder',$('#mailmergefolder').val());let A=document.querySelector('#mailmergefile').files;if(A.length!==0)formData.append('csv',A[0],'data.csv');else{rcmail.show_popup_dialog('No CSV File was selected!','Error');return}compose_id=$('[name=\'_id\']',form).val();formData.append('_compose_id',compose_id);formData.append('_mdn',document.querySelector('[name=_mdn]').checked);formData.append('_dsn',document.querySelector('[name=_dsn]').checked);formData.append('_priority',document.querySelector('[name=_priority]').value);console.log(formData);$.ajax({type:'POST',url:rcmail.url('plugin.mailmerge'),data:formData,contentType:!1,processData:!1,success:function(_){rcmail.http_response(_)},error:function(o,b,c){rcmail.http_error(o,b,c,!1,'plugin.mailmerge')}})}rcmail.addEventListener('init',function(B){console.log(B);rcmail.register_command('plugin.mailmerge',a,!0);rcmail.env.compose_commands.push('plugin.mailmerge');rcmail.http_get('plugin.mailmerge.get-folders')});rcmail.addEventListener('plugin.mailmerge.folders',function(C){var _b=C['special_folders']['drafts']??'Drafts';$.each(C['folders'],function(i,d){$('#mailmergefolder').append($('<option>',{value:d,text:d,selected:d===_b}))})});
